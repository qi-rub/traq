Contributing
============

1. `hpack` to regenerate the `.cabal` configuration (from `package.yaml`).
2. Tests are written using [`hspec`](https://hackage.haskell.org/package/hspec), in `test/`.
3. Formatting: [`formolu`](https://fourmolu.github.io/).

Design
------

### Lenses

For (deeply nested) data-structures, we manually write classy lenses to support access/updates, similar to ones generated by [microlens-th](https://hackage-content.haskell.org/package/microlens-th-0.4.3.17).

Here is an example: 
```haskell
-- | A function context contains a list of functions
type FunCtx ext = Ctx.Context (FunDef ext)

class HasFunCtx p ext | p -> ext where
  -- prefix the lens with an underscore.
  _funCtx :: Lens' p (FunCtx ext)

instance HasFunCtx (FunCtx ext) ext where _funCtx = id
```
